import gokart
import pandas as pd
import luigi


class GetDataSet(gokart.TaskOnKart):
    nrows = luigi.IntParameter()
    random_state = luigi.IntParameter()

    def run(self):
        train: pd.DataFrame = pd.read_csv(
            "../input/microsoft-malware-prediction/train.csv", low_memory=False,
        )
        test = pd.read_csv(
            "../input/microsoft-malware-prediction/test.csv", low_memory=False,
        )

        if self.nrows:
            train = train.sample(n=self.nrows, random_state=self.random_state)

        dataset = pd.concat([train, test])
        self.dump(dataset)
